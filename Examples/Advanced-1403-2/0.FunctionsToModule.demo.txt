~$global:ProgressPreference = 'SilentlyContinue'
~$cred = [System.Management.Automation.PSCredential]::new( 'admin', $( ConvertTo-SecureString 'netapp123' -AsPlainText -Force ) )
~$controller = Connect-NcController -Name Cluster01 -Credential $cred -Transient
~Clear-Host
###################################################################################
# Welcome to NetApp Insight Session 1403-2
#
# Functions and Modules
#
# If you are not using functions already I highly advise you to. They provide the ability to call the command from any location no matter the directory.
# The following piece of code is a script that collects the Volume Moves that are in progress then retypes their objects
#
code "$DemoRoot/../Source/Public/Copy-NcIgroup.script.ps1"
#
# To run this we provide the complete path and the parameters for the function.
#
$sourceIgroup = Get-NcIgroup -Vserver TestSVM -Name Sprint1
#
$sourceIgroup
#
. $DemoRoot/../Source/Scripts/Copy-NcIgroup.script.ps1 -Vserver TestSVM -NcIgroup $sourceIgroup -NewName 'CopyIgroupScript' -NewPortSetName CopyIgroupScript -NewPortSetPorts iscsi1,iscsi2
#
# This script is basic but it gets the job done.
# You may though want to share this script with your co-workes
# A module is a greate way to do this. The module is made up of a couple different parts. Let's look at them.
~Get-NcIgroup -Name CopyIgroupScript | Remove-NcIgroup -Confirm:$false
~Get-NcPortset -Name CopyIgroupScript | Remove-NcPortset -Confirm:$false
Clear-Host
code "$DemoRoot/../Source/Insight.psd1"
# The Manifest describes the content of the module. 

# 